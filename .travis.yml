sudo: required
services:
  - docker

before_install:
  - docker build -t istrupin/docker-compose-demo -f Dockerfile.dev .

script:
  - docker run -e CI=true istrupin/docker-compose-demo npm run test

deploy:
  provider: script
    script: git fetch --unshallow && git push https://$AZURE_WA_USERNAME:$AZURE_WA_PASSWORD@$AZURE_WA_SITE.scm.azurewebsites.net:443/$AZURE_WA_SITE.git HEAD:refs/heads/master
  verbose: true
  skip_cleanup: true